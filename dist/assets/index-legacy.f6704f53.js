!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t){return n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}function r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return i(t)}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(s){return void n(s)}a.done?t(u):Promise.resolve(u).then(r,o)}System.register(["./vendor-legacy.75f81643.js","./index-legacy.56242811.js","./index-legacy.ae4ffeac.js"],(function(e){"use strict";var o,c,a,l,p,d,v,y,m,h,w,b,g,O,k,L,j,E,S,P,U,T,B,R,z;return{setters:[function(e){o=e.R,c=e.x,a=e.w,l=e.F,p=e.G},function(e){d=e.a_,v=e.cH,y=e.gB,m=e.ap,h=e.gC,w=e.L,b=e.gy,g=e.S,O=e.aV,k=e.E,L=e.y,j=e.as,E=e.a3,S=e.gD},function(e){P=e.i,U=e.e,T=e.a,B=e.B,R=e.c,z=e.W}],execute:function(){function I(e){return function(){var t,n=(t=regeneratorRuntime.mark((function t(n,r){var o,i,c,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=d(r()),i=v(r(),o.id),c=i.automaticTimezone!==e,i.useAutomaticTimezone&&c&&(a={useAutomaticTimezone:"true",automaticTimezone:e,manualTimezone:i.manualTimezone},s=u(u({},o),{},{timezone:a}),y(s)(n,r)),t.abrupt("return",{});case 5:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function c(e){f(i,r,o,c,a,"next",e)}function a(e){f(i,r,o,c,a,"throw",e)}c(void 0)}))});return function(e,t){return n.apply(this,arguments)}}()}var x=m.dispatch,D=m.getState,_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(p,e);var o,u,f,l=r(p);function p(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),s(i(t=l.call(this,e)),"onDesktopMessageListener",(function(e){var n=e.origin,r=e.data,o=(r=void 0===r?{}:r).type,i=r.message,c=void 0===i?{}:i;if(t.props.currentUser&&n===window.location.origin)switch(o){case"register-desktop":var u=c.version;window.desktop||(window.desktop={}),window.desktop.version=a.valid(a.coerce(u));break;case"user-activity-update":var s=c.userIsActive,f=c.manual;!0!==s&&!1!==s||z.userUpdateActiveStatus(s,f);break;case"notification-clicked":var l=c.channel,p=c.teamId;window.focus(),t.props.actions.getChannelURLAction(l,p)}})),s(i(t),"handleBackSpace",(function(e){8!==e.which||["input","textarea"].includes(e.target.tagName.toLowerCase())||e.preventDefault()})),s(i(t),"handleBeforeUnload",(function(){window.removeEventListener("beforeunload",t.handleBeforeUnload),document.cookie.indexOf("".concat(g.COOKIE.SESSION_USER,"="))>-1&&O("",t.props.currentChannelId||"")(x,D),R()}));var n=document.getElementById("u3-chatting");return n&&(n.className+=" channel-view"),t}return o=p,(u=[{key:"isValidState",value:function(){return null!=this.props.currentUser}},{key:"componentDidMount",value:function(){var e=this.props,t=e.currentUser,n=e.enableTimezone,r=e.actions,o=e.location,i=e.history,c=e.clientId;if(P(),n&&r.autoUpdateTimezone(h()),window.addEventListener("beforeunload",this.handleBeforeUnload),window.addEventListener("focus",this.onFocusListener),window.addEventListener("blur",this.onBlurListener),document.hasFocus()||U(!1),window.addEventListener("message",this.onDesktopMessageListener),window.postMessage({type:"webapp-ready"},window.location.origin),!t)return w.removeUserId(c),w.removeToken(c),void T("/error?type=no-auth&redirect_to="+encodeURIComponent(o.pathname),!0,!1,i);window.addEventListener("keydown",this.handleBackSpace),this.isValidState()&&B.signalLogin()}},{key:"componentWillUnmount",value:function(){R(),window.removeEventListener("keydown",this.handleBackSpace),window.removeEventListener("focus",this.onFocusListener),window.removeEventListener("blur",this.onBlurListener),window.removeEventListener("message",this.onDesktopMessageListener)}},{key:"render",value:function(){return this.isValidState()?this.props.children:c(b,{message:"Xác thực tài khoản"})}},{key:"onFocusListener",value:function(){U(!0)}},{key:"onBlurListener",value:function(){U(!1)}}])&&t(o.prototype,u),f&&t(o,f),p}(o.PureComponent);var C=function(e,t){return function(n,r){return E.push(S(r(),e,t))}};e("default",l((function(e){var t=k(e),n=L();return{currentUser:d(e),currentChannelId:j(e),enableTimezone:"true"===t.ExperimentalTimezone,clientId:n.clientId}}),(function(e){return{actions:p({autoUpdateTimezone:I,getChannelURLAction:C},e)}}))(_))}}}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXgtbGVnYWN5LmY2NzA0ZjUzLmpzIiwic291cmNlcyI6WyIuLi8uLi9zcmMveC9wYWNrYWdlcy9jaGF0dGluZy1yZWR1eC9zcmMvYWN0aW9ucy90aW1lem9uZS50cyIsIi4uLy4uL3NyYy9jb21wb25lbnRzL0xvZ2dlZEluL0xvZ2dlZEluLnRzeCIsIi4uLy4uL3NyYy9jb21wb25lbnRzL0xvZ2dlZEluL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50IE1hdHRlcm1vc3QsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbi8vIFNlZSBMSUNFTlNFLnR4dCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbmltcG9ydCB7Z2V0Q3VycmVudFVzZXJ9IGZyb20gJ2NoYXR0aW5nLXJlZHV4L3NlbGVjdG9ycy9lbnRpdGllcy91c2Vycyc7XG5pbXBvcnQge2dldFVzZXJUaW1lem9uZX0gZnJvbSAnY2hhdHRpbmctcmVkdXgvc2VsZWN0b3JzL2VudGl0aWVzL3RpbWV6b25lJztcblxuaW1wb3J0IHtBY3Rpb25GdW5jLCBEaXNwYXRjaEZ1bmMsIEdldFN0YXRlRnVuY30gZnJvbSAnY2hhdHRpbmctcmVkdXgvdHlwZXMvYWN0aW9ucyc7XG5cbmltcG9ydCB7dXBkYXRlTWV9IGZyb20gJy4vdXNlcnMnO1xuXG5leHBvcnQgZnVuY3Rpb24gYXV0b1VwZGF0ZVRpbWV6b25lKGRldmljZVRpbWV6b25lOiBzdHJpbmcpOiBBY3Rpb25GdW5jIHtcbiAgcmV0dXJuIGFzeW5jIChkaXNwYXRjaDogRGlzcGF0Y2hGdW5jLCBnZXRTdGF0ZTogR2V0U3RhdGVGdW5jKSA9PiB7XG4gICAgY29uc3QgY3VycmVudFVlciA9IGdldEN1cnJlbnRVc2VyKGdldFN0YXRlKCkpO1xuICAgIGNvbnN0IGN1cnJlbnRUaW1lem9uZSA9IGdldFVzZXJUaW1lem9uZShnZXRTdGF0ZSgpLCBjdXJyZW50VWVyLmlkKTtcbiAgICBjb25zdCBuZXdUaW1lem9uZUV4aXN0cyA9IGN1cnJlbnRUaW1lem9uZS5hdXRvbWF0aWNUaW1lem9uZSAhPT0gZGV2aWNlVGltZXpvbmU7XG5cbiAgICBpZiAoY3VycmVudFRpbWV6b25lLnVzZUF1dG9tYXRpY1RpbWV6b25lICYmIG5ld1RpbWV6b25lRXhpc3RzKSB7XG4gICAgICBjb25zdCB0aW1lem9uZSA9IHtcbiAgICAgICAgdXNlQXV0b21hdGljVGltZXpvbmU6ICd0cnVlJyxcbiAgICAgICAgYXV0b21hdGljVGltZXpvbmU6IGRldmljZVRpbWV6b25lLFxuICAgICAgICBtYW51YWxUaW1lem9uZTogY3VycmVudFRpbWV6b25lLm1hbnVhbFRpbWV6b25lLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSB7XG4gICAgICAgIC4uLmN1cnJlbnRVZXIsXG4gICAgICAgIHRpbWV6b25lLFxuICAgICAgfTtcblxuICAgICAgdXBkYXRlTWUodXBkYXRlZFVzZXIpKGRpc3BhdGNoLCBnZXRTdGF0ZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHt9O1xuICB9O1xufVxuIiwiLyoqXG4gKiBGaWxlOiBMb2dnZWRJbi50c3hcbiAqIFByb2plY3Q6IGNoYXR0aW5nLW1pbmltYWxcbiAqIEZpbGUgQ3JlYXRlZDogMzAgU2VwIDIwMjEgMTA6NTM6NTFcbiAqIEF1dGhvcjogdW5kM2ZpbmVkIChtZUB1bmQzZmluZWQuY29tKVxuICogLS0tLS1cbiAqIExhc3QgTW9kaWZpZWQ6IDIzIE5vdiAyMDIxIDE4OjE0OjU0XG4gKiBNb2RpZmllZCBCeTogdW5kM2ZpbmVkIChtZUB1bmQzZmluZWQuY29tKVxuICogLS0tLS1cbiAqIENvcHlyaWdodCAoYykgMjAyMSB1bmQzZmluZWQuY29tXG4gKi9cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmltcG9ydCBzZW12ZXIgZnJvbSAnc2VtdmVyJztcblxuaW1wb3J0IHt2aWV3Q2hhbm5lbH0gZnJvbSAnY2hhdHRpbmctcmVkdXgvYWN0aW9ucy9jaGFubmVscyc7XG5pbXBvcnQgR2VuZXJhbCBmcm9tICdjaGF0dGluZy1yZWR1eC9jb25zdGFudHMvZ2VuZXJhbCc7XG5cbmltcG9ydCAqIGFzIEdsb2JhbEFjdGlvbnMgZnJvbSAnJGFjdGlvbnMvZ2xvYmFsX2FjdGlvbnMnO1xuaW1wb3J0ICogYXMgV2ViU29ja2V0QWN0aW9ucyBmcm9tICckYWN0aW9ucy93ZWJzb2NrZXRfYWN0aW9ucy5qc3gnO1xuaW1wb3J0IHtnZXRCcm93c2VyVGltZXpvbmV9IGZyb20gJyR1dGlscy90aW1lem9uZS5qc3gnO1xuaW1wb3J0IHN0b3JlIGZyb20gJyRzdG9yZXMvcmVkdXhfc3RvcmUuanN4JztcbmltcG9ydCBXZWJTb2NrZXRDbGllbnQgZnJvbSAnJGNsaWVudC93ZWJfd2Vic29ja2V0X2NsaWVudC5qc3gnO1xuaW1wb3J0IEJyb3dzZXJTdG9yZSBmcm9tICckc3RvcmVzL2Jyb3dzZXJfc3RvcmUnO1xuaW1wb3J0IExvY2FsU3RvcmFnZVN0b3JlIGZyb20gJyRzdG9yZXMvbG9jYWxfc3RvcmFnZV9zdG9yZSc7XG5cbmltcG9ydCBMb2FkaW5nU2NyZWVuIGZyb20gJ0Bjb21wb25lbnRzL0xvYWRpbmdTY3JlZW4nO1xuXG5pbXBvcnQgdHlwZSB7U3RhdGUsIFByb3BzfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7RGlzcGF0Y2hGdW5jfSBmcm9tICdjaGF0dGluZy1yZWR1eC90eXBlcy9hY3Rpb25zJztcblxuY29uc3QgZGlzcGF0Y2ggPSBzdG9yZS5kaXNwYXRjaDtcbmNvbnN0IGdldFN0YXRlID0gc3RvcmUuZ2V0U3RhdGU7XG5cbmNvbnN0IEJBQ0tTUEFDRV9DSEFSID0gODtcblxuY2xhc3MgTG9nZ2VkSW4gZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG5cbiAgICBjb25zdCByb290ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3UzLWNoYXR0aW5nJyk7XG4gICAgaWYgKHJvb3QpIHtcbiAgICAgIHJvb3QuY2xhc3NOYW1lICs9ICcgY2hhbm5lbC12aWV3JztcbiAgICB9XG4gIH1cblxuICBpc1ZhbGlkU3RhdGUoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuY3VycmVudFVzZXIgIT0gbnVsbDtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIGNvbnN0IHtjdXJyZW50VXNlciwgZW5hYmxlVGltZXpvbmUsIGFjdGlvbnMsIGxvY2F0aW9uLCBoaXN0b3J5LCBjbGllbnRJZH0gPSB0aGlzLnByb3BzO1xuXG4gICAgLy8gSW5pdGlhbGl6ZSB3ZWJzb2NrZXRcbiAgICBXZWJTb2NrZXRBY3Rpb25zLmluaXRpYWxpemUoKTtcblxuICAgIGlmIChlbmFibGVUaW1lem9uZSkge1xuICAgICAgYWN0aW9ucy5hdXRvVXBkYXRlVGltZXpvbmUoZ2V0QnJvd3NlclRpbWV6b25lKCkpO1xuICAgIH1cblxuICAgIC8vIE1ha2Ugc3VyZSB0aGUgd2Vic29ja2V0cyBjbG9zZSBhbmQgcmVzZXQgdmVyc2lvblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCB0aGlzLmhhbmRsZUJlZm9yZVVubG9hZCk7XG5cbiAgICAvLyBMaXN0ZW4gZm9yIGZvY3VzZWQgdGFiL3dpbmRvdyBzdGF0ZVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMub25Gb2N1c0xpc3RlbmVyKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMub25CbHVyTGlzdGVuZXIpO1xuICAgIGlmICghZG9jdW1lbnQuaGFzRm9jdXMoKSkge1xuICAgICAgR2xvYmFsQWN0aW9ucy5lbWl0QnJvd3NlckZvY3VzKGZhbHNlKTtcbiAgICB9XG5cbiAgICAvLyBMaXN0ZW4gZm9yIG1lc3NhZ2VzIGZyb20gdGhlIGRlc2t0b3AgYXBwXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLm9uRGVza3RvcE1lc3NhZ2VMaXN0ZW5lcik7XG5cbiAgICAvLyBUZWxsIHRoZSBkZXNrdG9wIGFwcCB0aGUgd2ViYXBwIGlzIHJlYWR5XG4gICAgd2luZG93LnBvc3RNZXNzYWdlKHt0eXBlOiAnd2ViYXBwLXJlYWR5J30sIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pO1xuXG4gICAgaWYgKCFjdXJyZW50VXNlcikge1xuICAgICAgTG9jYWxTdG9yYWdlU3RvcmUucmVtb3ZlVXNlcklkKGNsaWVudElkKTtcbiAgICAgIExvY2FsU3RvcmFnZVN0b3JlLnJlbW92ZVRva2VuKGNsaWVudElkKTtcblxuICAgICAgR2xvYmFsQWN0aW9ucy5lbWl0VXNlckxvZ2dlZE91dEV2ZW50KFxuICAgICAgICAnL2Vycm9yP3R5cGU9bm8tYXV0aCZyZWRpcmVjdF90bz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGxvY2F0aW9uLnBhdGhuYW1lKSxcbiAgICAgICAgdHJ1ZSxcbiAgICAgICAgZmFsc2UsXG4gICAgICAgIGhpc3RvcnksXG4gICAgICApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFByZXZlbnQgYmFja3NwYWNlIGZyb20gbmF2aWdhdGluZyBiYWNrIGEgcGFnZVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVCYWNrU3BhY2UpO1xuXG4gICAgaWYgKHRoaXMuaXNWYWxpZFN0YXRlKCkpIHtcbiAgICAgIEJyb3dzZXJTdG9yZS5zaWduYWxMb2dpbigpO1xuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIFdlYlNvY2tldEFjdGlvbnMuY2xvc2UoKTtcblxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVCYWNrU3BhY2UpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMub25Gb2N1c0xpc3RlbmVyKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMub25CbHVyTGlzdGVuZXIpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5vbkRlc2t0b3BNZXNzYWdlTGlzdGVuZXIpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGlmICghdGhpcy5pc1ZhbGlkU3RhdGUoKSkge1xuICAgICAgcmV0dXJuIDxMb2FkaW5nU2NyZWVuIG1lc3NhZ2U9J1jDoWMgdGjhu7FjIHTDoGkga2hv4bqjbicgLz47XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucHJvcHMuY2hpbGRyZW47XG4gIH1cblxuICBvbkZvY3VzTGlzdGVuZXIoKSB7XG4gICAgR2xvYmFsQWN0aW9ucy5lbWl0QnJvd3NlckZvY3VzKHRydWUpO1xuICB9XG5cbiAgb25CbHVyTGlzdGVuZXIoKSB7XG4gICAgR2xvYmFsQWN0aW9ucy5lbWl0QnJvd3NlckZvY3VzKGZhbHNlKTtcbiAgfVxuXG4gIC8vIGxpc3RlbiBmb3IgbWVzc2FnZXMgZnJvbSB0aGUgZGVza3RvcCBhcHBcbiAgb25EZXNrdG9wTWVzc2FnZUxpc3RlbmVyID0gKGV2OiBNZXNzYWdlRXZlbnQ8YW55PikgPT4ge1xuICAgIGNvbnN0IHtvcmlnaW4sIGRhdGE6IHt0eXBlLCBtZXNzYWdlID0ge319ID0ge319ID0gZXY7XG5cbiAgICBpZiAoIXRoaXMucHJvcHMuY3VycmVudFVzZXIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKG9yaWdpbiAhPT0gd2luZG93LmxvY2F0aW9uLm9yaWdpbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSAncmVnaXN0ZXItZGVza3RvcCc6IHtcbiAgICAgICAgY29uc3Qge3ZlcnNpb259ID0gbWVzc2FnZTtcbiAgICAgICAgaWYgKCF3aW5kb3cuZGVza3RvcCkge1xuICAgICAgICAgIHdpbmRvdy5kZXNrdG9wID0ge307XG4gICAgICAgIH1cbiAgICAgICAgd2luZG93LmRlc2t0b3AudmVyc2lvbiA9IHNlbXZlci52YWxpZChzZW12ZXIuY29lcmNlKHZlcnNpb24pKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICd1c2VyLWFjdGl2aXR5LXVwZGF0ZSc6IHtcbiAgICAgICAgY29uc3Qge3VzZXJJc0FjdGl2ZSwgbWFudWFsfSA9IG1lc3NhZ2U7XG5cbiAgICAgICAgLy8gdXBkYXRlIHRoZSBzZXJ2ZXIgd2l0aCB0aGUgdXNlcnMgY3VycmVudCBhd2F5IHN0YXR1c1xuICAgICAgICBpZiAodXNlcklzQWN0aXZlID09PSB0cnVlIHx8IHVzZXJJc0FjdGl2ZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBXZWJTb2NrZXRDbGllbnQudXNlclVwZGF0ZUFjdGl2ZVN0YXR1cyh1c2VySXNBY3RpdmUsIG1hbnVhbCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdub3RpZmljYXRpb24tY2xpY2tlZCc6IHtcbiAgICAgICAgY29uc3Qge2NoYW5uZWwsIHRlYW1JZH0gPSBtZXNzYWdlO1xuICAgICAgICB3aW5kb3cuZm9jdXMoKTtcblxuICAgICAgICAvLyBuYXZpZ2F0ZSB0byB0aGUgYXBwcm9wcmlhdGUgY2hhbm5lbFxuICAgICAgICB0aGlzLnByb3BzLmFjdGlvbnMuZ2V0Q2hhbm5lbFVSTEFjdGlvbihjaGFubmVsLCB0ZWFtSWQpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgaGFuZGxlQmFja1NwYWNlID0gKGU6IGFueSkgPT4ge1xuICAgIGNvbnN0IGV4Y2x1ZGVkRWxlbWVudHMgPSBbJ2lucHV0JywgJ3RleHRhcmVhJ107XG5cbiAgICBpZiAoZS53aGljaCA9PT0gQkFDS1NQQUNFX0NIQVIgJiYgIWV4Y2x1ZGVkRWxlbWVudHMuaW5jbHVkZXMoZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfTtcblxuICBoYW5kbGVCZWZvcmVVbmxvYWQgPSAoKSA9PiB7XG4gICAgLy8gcmVtb3ZlIHRoZSBldmVudCBsaXN0ZW5lciB0byBwcmV2ZW50IGdldHRpbmcgc3R1Y2sgaW4gYSBsb29wXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIHRoaXMuaGFuZGxlQmVmb3JlVW5sb2FkKTtcblxuICAgIGlmIChkb2N1bWVudC5jb29raWUuaW5kZXhPZihgJHtHZW5lcmFsLkNPT0tJRS5TRVNTSU9OX1VTRVJ9PWApID4gLTEpIHtcbiAgICAgIHZpZXdDaGFubmVsKCcnLCB0aGlzLnByb3BzLmN1cnJlbnRDaGFubmVsSWQgfHwgJycpKGRpc3BhdGNoIGFzIERpc3BhdGNoRnVuYywgZ2V0U3RhdGUpO1xuICAgIH1cbiAgICBXZWJTb2NrZXRBY3Rpb25zLmNsb3NlKCk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IExvZ2dlZEluO1xuIiwiLyoqXG4gKiBGaWxlOiBpbmRleC50c1xuICogUHJvamVjdDogY2hhdHRpbmctbWluaW1hbFxuICogRmlsZSBDcmVhdGVkOiAzMCBTZXAgMjAyMSAxMDo1Mzo0MVxuICogQXV0aG9yOiB1bmQzZmluZWQgKG1lQHVuZDNmaW5lZC5jb20pXG4gKiAtLS0tLVxuICogTGFzdCBNb2RpZmllZDogMjMgTm92IDIwMjEgMTg6MTQ6NDFcbiAqIE1vZGlmaWVkIEJ5OiB1bmQzZmluZWQgKG1lQHVuZDNmaW5lZC5jb20pXG4gKiAtLS0tLVxuICogQ29weXJpZ2h0IChjKSAyMDIxIHVuZDNmaW5lZC5jb21cbiAqL1xuaW1wb3J0IHtjb25uZWN0fSBmcm9tICdyZWFjdC1yZWR1eCc7XG5pbXBvcnQge2JpbmRBY3Rpb25DcmVhdG9ycywgRGlzcGF0Y2h9IGZyb20gJ3JlZHV4JztcblxuaW1wb3J0IHthdXRvVXBkYXRlVGltZXpvbmV9IGZyb20gJ2NoYXR0aW5nLXJlZHV4L2FjdGlvbnMvdGltZXpvbmUnO1xuaW1wb3J0IHtnZXRDdXJyZW50Q2hhbm5lbElkfSBmcm9tICdjaGF0dGluZy1yZWR1eC9zZWxlY3RvcnMvZW50aXRpZXMvY2hhbm5lbHMnO1xuaW1wb3J0IHsgZ2V0Q29uZmlnfSBmcm9tICdjaGF0dGluZy1yZWR1eC9zZWxlY3RvcnMvZW50aXRpZXMvZ2VuZXJhbCc7XG5pbXBvcnQge2dldEN1cnJlbnRVc2VyfSBmcm9tICdjaGF0dGluZy1yZWR1eC9zZWxlY3RvcnMvZW50aXRpZXMvdXNlcnMnO1xuaW1wb3J0IHsgR2VuZXJpY0FjdGlvbiB9IGZyb20gJ2NoYXR0aW5nLXJlZHV4L3R5cGVzL2FjdGlvbnMnO1xuXG5pbXBvcnQge2Jyb3dzZXJIaXN0b3J5fSBmcm9tICckdXRpbHMvYnJvd3Nlcl9oaXN0b3J5JztcbmltcG9ydCB7Z2V0Q2hhbm5lbFVSTH0gZnJvbSAnJHV0aWxzL3V0aWxzJztcblxuaW1wb3J0IHsgZ2V0SW5pdERhdGEgfSBmcm9tICdAdXRpbHMvaW50ZWdyYXRlJztcblxuaW1wb3J0IExvZ2dlZEluIGZyb20gJy4vTG9nZ2VkSW4nO1xuaW1wb3J0IHsgR2xvYmFsU3RhdGUgfSBmcm9tICckdHlwZXMvc3RvcmUnO1xuaW1wb3J0IHtTdGF0ZVByb3BzLCBEaXNwYXRjaFByb3BzLCBPd25Qcm9wcyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgQ2hhbm5lbCB9IGZyb20gJ2NoYXR0aW5nLXJlZHV4L3R5cGVzL2NoYW5uZWxzJztcblxuZnVuY3Rpb24gbWFwU3RhdGVUb1Byb3BzKHN0YXRlOiBHbG9iYWxTdGF0ZSk6IFN0YXRlUHJvcHMge1xuICBjb25zdCBjb25maWcgPSBnZXRDb25maWcoc3RhdGUpO1xuICBjb25zdCBjbGllbnRJbmZvID0gZ2V0SW5pdERhdGEoKTtcblxuICByZXR1cm4ge1xuICAgIGN1cnJlbnRVc2VyOiBnZXRDdXJyZW50VXNlcihzdGF0ZSksXG4gICAgY3VycmVudENoYW5uZWxJZDogZ2V0Q3VycmVudENoYW5uZWxJZChzdGF0ZSksXG4gICAgZW5hYmxlVGltZXpvbmU6IGNvbmZpZy5FeHBlcmltZW50YWxUaW1lem9uZSA9PT0gJ3RydWUnLFxuICAgIGNsaWVudElkOiBjbGllbnRJbmZvLmNsaWVudElkLFxuICB9O1xufVxuXG5jb25zdCBnZXRDaGFubmVsVVJMQWN0aW9uID0gKGNoYW5uZWw6IENoYW5uZWwsIHRlYW1JZDogc3RyaW5nKSA9PiAoZGlzcGF0Y2g6IERpc3BhdGNoLCBnZXRTdGF0ZTogKCkgPT4gR2xvYmFsU3RhdGUpID0+IGJyb3dzZXJIaXN0b3J5LnB1c2goZ2V0Q2hhbm5lbFVSTChnZXRTdGF0ZSgpLCBjaGFubmVsLCB0ZWFtSWQpKTtcblxuZnVuY3Rpb24gbWFwRGlzcGF0Y2hUb1Byb3BzKGRpc3BhdGNoOiBEaXNwYXRjaDxHZW5lcmljQWN0aW9uPikge1xuICByZXR1cm4ge1xuICAgIGFjdGlvbnM6IGJpbmRBY3Rpb25DcmVhdG9ycyhcbiAgICAgIHtcbiAgICAgICAgYXV0b1VwZGF0ZVRpbWV6b25lLFxuICAgICAgICBnZXRDaGFubmVsVVJMQWN0aW9uLFxuICAgICAgfSxcbiAgICAgIGRpc3BhdGNoXG4gICAgKSxcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY29ubmVjdDxTdGF0ZVByb3BzLCBEaXNwYXRjaFByb3BzLCBPd25Qcm9wcywgR2xvYmFsU3RhdGU+KG1hcFN0YXRlVG9Qcm9wcywgbWFwRGlzcGF0Y2hUb1Byb3BzKShMb2dnZWRJbik7XG4iXSwibmFtZXMiOlsiZGV2aWNlVGltZXpvbmUiLCJkaXNwYXRjaCIsImdldFN0YXRlIiwiY3VycmVudFVlciIsImdldEN1cnJlbnRVc2VyIiwiY3VycmVudFRpbWV6b25lIiwiZ2V0VXNlclRpbWV6b25lIiwiaWQiLCJuZXdUaW1lem9uZUV4aXN0cyIsImF1dG9tYXRpY1RpbWV6b25lIiwidXNlQXV0b21hdGljVGltZXpvbmUiLCJ0aW1lem9uZSIsIm1hbnVhbFRpbWV6b25lIiwidXBkYXRlZFVzZXIiLCJzdG9yZSIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJfZGVmaW5lUHJvcGVydHkiLCJldiIsIm9yaWdpbiIsImRhdGEiLCJ0eXBlIiwibWVzc2FnZSIsIl90aGlzIiwiY3VycmVudFVzZXIiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInZlcnNpb24iLCJkZXNrdG9wIiwic2VtdmVyIiwidmFsaWQiLCJjb2VyY2UiLCJ1c2VySXNBY3RpdmUiLCJtYW51YWwiLCJ1c2VyVXBkYXRlQWN0aXZlU3RhdHVzIiwiY2hhbm5lbCIsInRlYW1JZCIsImZvY3VzIiwiYWN0aW9ucyIsImdldENoYW5uZWxVUkxBY3Rpb24iLCJlIiwid2hpY2giLCJpbmNsdWRlcyIsInRhcmdldCIsInRhZ05hbWUiLCJ0b0xvd2VyQ2FzZSIsInByZXZlbnREZWZhdWx0IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImhhbmRsZUJlZm9yZVVubG9hZCIsImRvY3VtZW50IiwiY29va2llIiwiaW5kZXhPZiIsIkdlbmVyYWwiLCJDT09LSUUiLCJTRVNTSU9OX1VTRVIiLCJjdXJyZW50Q2hhbm5lbElkIiwicm9vdCIsImdldEVsZW1lbnRCeUlkIiwiY2xhc3NOYW1lIiwiaXNWYWxpZFN0YXRlIiwiY29tcG9uZW50RGlkTW91bnQiLCJ0aGlzIiwiZW5hYmxlVGltZXpvbmUiLCJoaXN0b3J5IiwiY2xpZW50SWQiLCJhdXRvVXBkYXRlVGltZXpvbmUiLCJnZXRCcm93c2VyVGltZXpvbmUiLCJhZGRFdmVudExpc3RlbmVyIiwib25Gb2N1c0xpc3RlbmVyIiwib25CbHVyTGlzdGVuZXIiLCJoYXNGb2N1cyIsIm9uRGVza3RvcE1lc3NhZ2VMaXN0ZW5lciIsInBvc3RNZXNzYWdlIiwicmVtb3ZlVXNlcklkIiwicmVtb3ZlVG9rZW4iLCJlbmNvZGVVUklDb21wb25lbnQiLCJwYXRobmFtZSIsImhhbmRsZUJhY2tTcGFjZSIsInNpZ25hbExvZ2luIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJyZW5kZXIiLCJjaGlsZHJlbiIsIkxvYWRpbmdTY3JlZW4iLCJSZWFjdCIsIlB1cmVDb21wb25lbnQiLCJicm93c2VySGlzdG9yeSIsInB1c2giLCJnZXRDaGFubmVsVVJMIiwiY29ubmVjdCIsInN0YXRlIiwiY29uZmlnIiwiZ2V0Q29uZmlnIiwiY2xpZW50SW5mbyIsImdldEluaXREYXRhIiwiZ2V0Q3VycmVudENoYW5uZWxJZCIsIkV4cGVyaW1lbnRhbFRpbWV6b25lIiwiYmluZEFjdGlvbkNyZWF0b3JzIiwiTG9nZ2VkSW4iXSwibWFwcGluZ3MiOiIwaUZBU21DQSx5REFDMUIsV0FBT0MsRUFBd0JDLGlHQUEvQixPQUNDQyxFQUFhQyxFQUFlRixLQUM1QkcsRUFBa0JDLEVBQWdCSixJQUFZQyxFQUFXSSxJQUN6REMsRUFBb0JILEVBQWdCSSxvQkFBc0JULEVBRTVESyxFQUFnQkssc0JBQXdCRixJQUNwQ0csRUFBVyxDQUNmRCxxQkFBc0IsT0FDdEJELGtCQUFtQlQsRUFDbkJZLGVBQWdCUCxFQUFnQk8sZ0JBRzVCQyxTQUNEVixPQUNIUSxTQUFBQSxNQUdPRSxHQUFhWixFQUFVQyxzQkFHM0IscVJDQ1gsSUFBTUQsRUFBV2EsRUFBTWIsU0FDakJDLEVBQVdZLEVBQU1aLGlSQUtyQmEsV0FBWUMsK0dBQWNDLGtCQUNsQkQsZ0NBcUZtQixTQUFDRSxPQUNuQkMsRUFBMkNELEVBQTNDQyxTQUEyQ0QsRUFBbkNFLEtBQU9DLGdCQUFzQixNQUF0QkEsU0FBTUMsUUFBQUEsYUFBVSxRQUVqQ0MsRUFBS1AsTUFBTVEsYUFHWkwsSUFBV00sT0FBT0MsU0FBU1AsY0FJdkJFLE9BQ0QsdUJBQ0lNLEVBQVdMLEVBQVhLLFFBQ0ZGLE9BQU9HLGlCQUNIQSxRQUFVLFdBRVpBLFFBQVFELFFBQVVFLEVBQU9DLE1BQU1ELEVBQU9FLE9BQU9KLGNBR2pELDJCQUNJSyxFQUF3QlYsRUFBeEJVLGFBQWNDLEVBQVVYLEVBQVZXLFFBR0EsSUFBakJELElBQTBDLElBQWpCQSxLQUNYRSx1QkFBdUJGLEVBQWNDLGFBSXBELDJCQUNJRSxFQUFtQmIsRUFBbkJhLFFBQVNDLEVBQVVkLEVBQVZjLGNBQ1RDLFVBR0ZyQixNQUFNc0IsUUFBUUMsb0JBQW9CSixFQUFTQyxpQ0FNcEMsU0FBQ0ksR0FoSUUsSUFtSWZBLEVBQUVDLE9BRm1CLENBQUMsUUFBUyxZQUVpQkMsU0FBU0YsRUFBRUcsT0FBT0MsUUFBUUMsa0JBQzFFQyxpREFJZSxrQkFFWkMsb0JBQW9CLGVBQWdCeEIsRUFBS3lCLG9CQUU1Q0MsU0FBU0MsT0FBT0Msa0JBQVdDLEVBQVFDLE9BQU9DLHlCQUNoQyxHQUFJL0IsRUFBS1AsTUFBTXVDLGtCQUFvQixJQUFJdEQsRUFBMEJDLGNBdkl6RXNELEVBQU9QLFNBQVNRLGVBQWUsZUFIYixPQUlwQkQsTUFDR0UsV0FBYSw0REFJdEJDLGtCQUNtQyxXQUFyQjNDLE1BQU1RLDZDQUdwQm9DLGlCQUM4RUMsS0FBSzdDLE1BQTFFUSxJQUFBQSxZQUFhc0MsSUFBQUEsZUFBZ0J4QixJQUFBQSxRQUFTWixJQUFBQSxTQUFVcUMsSUFBQUEsUUFBU0MsSUFBQUEsZ0JBSzVERixLQUNNRyxtQkFBbUJDLFlBSXRCQyxpQkFBaUIsZUFBZ0JOLEtBQUtiLDJCQUd0Q21CLGlCQUFpQixRQUFTTixLQUFLTyx3QkFDL0JELGlCQUFpQixPQUFRTixLQUFLUSxnQkFDaENwQixTQUFTcUIsZUFDbUIsVUFJMUJILGlCQUFpQixVQUFXTixLQUFLVSxpQ0FHakNDLFlBQVksQ0FBQ25ELEtBQU0sZ0JBQWlCSSxPQUFPQyxTQUFTUCxTQUV0REssV0FDZWlELGFBQWFULEtBQ2JVLFlBQVlWLFVBRzVCLG1DQUFxQ1csbUJBQW1CakQsRUFBU2tELFdBQ2pFLEdBQ0EsRUFDQWIsVUFNR0ksaUJBQWlCLFVBQVdOLEtBQUtnQixpQkFFcENoQixLQUFLRixrQkFDTW1CLGtEQUlqQkMsc0JBR1NoQyxvQkFBb0IsVUFBV2MsS0FBS2dCLHdCQUNwQzlCLG9CQUFvQixRQUFTYyxLQUFLTyx3QkFDbENyQixvQkFBb0IsT0FBUWMsS0FBS1EsdUJBQ2pDdEIsb0JBQW9CLFVBQVdjLEtBQUtVLGdEQUc3Q1Msa0JBQ09uQixLQUFLRixvQkFJRTNDLE1BQU1pRSxXQUhSQyxHQUFjNUQsUUFBUSxzREFNbEM4QyxjQUNpQyxpQ0FHakNDLGNBQ2lDLHNDQW5GWmMsRUFBTUMsZUNNN0IsSUFBTTdDLEVBQXNCLFNBQUNKLEVBQWtCQyxtQkFBb0JuQyxFQUFvQkMsVUFBZ0NtRixFQUFlQyxLQUFLQyxFQUFjckYsSUFBWWlDLEVBQVNDLGtCQWMvSm9ELEdBMUJmLFNBQXlCQyxPQUNqQkMsRUFBU0MsRUFBVUYsR0FDbkJHLEVBQWFDLFVBRVosQ0FDTHJFLFlBQWFwQixFQUFlcUYsR0FDNUJsQyxpQkFBa0J1QyxFQUFvQkwsR0FDdEMzQixlQUFnRCxTQUFoQzRCLEVBQU9LLHFCQUN2Qi9CLFNBQVU0QixFQUFXNUIsYUFNekIsU0FBNEIvRCxTQUNuQixDQUNMcUMsUUFBUzBELEVBQ1AsQ0FDRS9CLG1CQUFBQSxFQUNBMUIsb0JBQUFBLEdBRUZ0QyxNQUtTdUYsQ0FBK0ZTIn0=
